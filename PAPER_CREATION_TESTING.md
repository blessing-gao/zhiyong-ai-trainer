# 试卷创建功能 - 测试指南

## 🚀 快速开始

### 前置条件
1. 后端服务已启动（端口8089）
2. 前端开发服务已启动（端口5173）
3. 数据库已连接
4. 一级知识点数据已存在

### 启动步骤

#### 1. 启动后端服务
```bash
cd zhiyong-backend
mvn spring-boot:run
```

#### 2. 启动前端开发服务
```bash
cd zhiyong-fronted
npm run dev
```

#### 3. 访问应用
```
http://localhost:5173
```

## 📝 测试用例

### TC001: 打开新增试卷对话框

**步骤**:
1. 登录管理员账户
2. 进入"试卷管理"模块
3. 点击"新增试卷"按钮

**预期结果**:
- ✅ 对话框打开
- ✅ 显示所有表单字段
- ✅ 知识点自动加载
- ✅ 表单显示默认值

### TC002: 填写试卷基本信息

**步骤**:
1. 打开新增试卷对话框
2. 输入以下信息：
   - 试卷名称：高考数学模拟卷
   - 试卷类型：正式考试卷
   - 试卷说明：2025年高考数学模拟卷
   - 试卷总分：150
   - 及格分数：90
   - 考试时长：120
   - 题目总数：100

**预期结果**:
- ✅ 所有字段正确显示
- ✅ 没有验证错误

### TC003: 配置题型比例

**步骤**:
1. 打开新增试卷对话框
2. 修改题型比例：
   - 判断题：20
   - 单选题：70
   - 多选题：10

**预期结果**:
- ✅ 比例总和显示为100%
- ✅ 没有验证错误

### TC004: 配置知识点比例

**步骤**:
1. 打开新增试卷对话框
2. 查看知识点比例
3. 验证所有知识点都已加载
4. 验证比例总和为100%

**预期结果**:
- ✅ 所有知识点已加载
- ✅ 比例均匀分配
- ✅ 比例总和为100%

### TC005: 创建试卷成功

**步骤**:
1. 打开新增试卷对话框
2. 填写所有必填字段
3. 配置题型比例和知识点比例
4. 点击"创建试卷"按钮

**预期结果**:
- ✅ 按钮显示"创建中..."
- ✅ 后端接收请求
- ✅ 后端执行组卷算法
- ✅ 对话框自动关闭
- ✅ 试卷列表刷新
- ✅ 新创建的试卷出现在列表中

### TC006: 试卷名称为空

**步骤**:
1. 打开新增试卷对话框
2. 清空试卷名称
3. 点击"创建试卷"按钮

**预期结果**:
- ✅ 显示错误提示："试卷名称不能为空"
- ✅ 对话框保持打开
- ✅ 不调用后端API

### TC007: 及格分数大于总分

**步骤**:
1. 打开新增试卷对话框
2. 设置试卷总分：100
3. 设置及格分数：150
4. 点击"创建试卷"按钮

**预期结果**:
- ✅ 显示错误提示："及格分数不能大于试卷总分"
- ✅ 对话框保持打开
- ✅ 不调用后端API

### TC008: 题型比例不等于100

**步骤**:
1. 打开新增试卷对话框
2. 修改题型比例：
   - 判断题：20
   - 单选题：70
   - 多选题：5
3. 点击"创建试卷"按钮

**预期结果**:
- ✅ 显示错误提示："题型比例之和必须等于100，当前为: 95"
- ✅ 对话框保持打开
- ✅ 不调用后端API

### TC009: 知识点比例不等于100

**步骤**:
1. 打开新增试卷对话框
2. 修改知识点比例，使总和不等于100
3. 点击"创建试卷"按钮

**预期结果**:
- ✅ 显示错误提示："知识点比例之和必须等于100，当前为: XX"
- ✅ 对话框保持打开
- ✅ 不调用后端API

### TC010: 关闭对话框

**步骤**:
1. 打开新增试卷对话框
2. 填写部分信息
3. 点击"取消"按钮或X按钮

**预期结果**:
- ✅ 对话框关闭
- ✅ 表单数据重置
- ✅ 不调用后端API

## 🔍 调试技巧

### 查看浏览器控制台
```
F12 或 右键 -> 检查 -> Console
```

### 查看网络请求
```
F12 -> Network -> 查看POST /api/papers请求
```

### 查看后端日志
```
后端控制台输出组卷日志
```

## 📊 测试数据

### 标准测试数据

```json
{
  "name": "高考数学模拟卷",
  "description": "2025年高考数学模拟卷",
  "type": "exam",
  "totalScore": 150,
  "passScore": 90,
  "duration": 120,
  "questionCount": 100,
  "typeRatio": {
    "judge": 20,
    "single": 70,
    "multiple": 10
  },
  "knowledgeRatio": {
    "1": 20,
    "2": 20,
    "3": 20,
    "4": 20,
    "5": 20
  }
}
```

### 练习卷测试数据

```json
{
  "name": "数学练习卷",
  "description": "基础知识练习",
  "type": "practice",
  "totalScore": 100,
  "passScore": 60,
  "duration": 60,
  "questionCount": 50,
  "typeRatio": {
    "judge": 30,
    "single": 50,
    "multiple": 20
  },
  "knowledgeRatio": {
    "1": 25,
    "2": 25,
    "3": 25,
    "4": 25
  }
}
```

## ✅ 测试清单

- [ ] TC001: 打开对话框
- [ ] TC002: 填写基本信息
- [ ] TC003: 配置题型比例
- [ ] TC004: 配置知识点比例
- [ ] TC005: 创建试卷成功
- [ ] TC006: 试卷名称为空
- [ ] TC007: 及格分数大于总分
- [ ] TC008: 题型比例不等于100
- [ ] TC009: 知识点比例不等于100
- [ ] TC010: 关闭对话框

## 🐛 常见问题

### Q1: 对话框打开后知识点加载失败

**原因**: 后端API返回错误或网络问题

**解决方案**:
1. 检查后端服务是否运行
2. 检查浏览器控制台错误信息
3. 检查网络请求状态

### Q2: 创建试卷后列表没有刷新

**原因**: API调用成功但列表刷新失败

**解决方案**:
1. 手动刷新页面
2. 检查浏览器控制台错误信息
3. 检查后端返回的数据格式

### Q3: 表单验证错误提示不显示

**原因**: 验证逻辑有问题

**解决方案**:
1. 检查浏览器控制台
2. 查看validateForm()函数
3. 检查错误提示的显示条件

## 📈 性能测试

### 加载时间
- 对话框打开：< 1秒
- 知识点加载：< 500ms
- 创建试卷：< 5秒

### 内存占用
- 对话框打开：< 10MB增长
- 创建试卷：< 20MB增长

## 🎯 验收标准

- [x] 新增试卷按钮可点击
- [x] 对话框正确显示
- [x] 表单验证正确
- [x] API调用成功
- [x] 试卷列表刷新
- [x] 错误提示清晰
- [x] 加载状态显示
- [x] 前端编译成功

---

**测试完成时间**: 2025-10-18  
**版本**: 1.0  
**状态**: ✅ 完成

